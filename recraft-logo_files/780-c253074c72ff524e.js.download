try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ef8d2b96-992d-4a17-b560-99d3ab25e665",e._sentryDebugIdIdentifier="sentry-dbid-ef8d2b96-992d-4a17-b560-99d3ab25e665")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{65953:function(e,t,i){i.d(t,{K:function(){return r},c:function(){return a}});var n=i(16689),s=i(78009),o=i(79768);let r=e=>{let t=[];(0,o.uV)(e)&&t.push(n.A.Alt),(0,o.wE)(e)&&t.push(n.A.Shift),(0,o.cU)(e)&&t.push(s.m?n.A.MetaRight:n.A.ControlRight),t.push(e.key),console.debug('await page.keyboard.press("'.concat(t.join("+"),'")'))};class a{constructor(){this.isDown=!1,this.deferredDown=null,this.moveLogPeriod=1e3,this.lastMoveAt=null,this.logMove=e=>{this.deferredDown?(console.debug("await editor.canvasMouseMove(".concat(this.deferredDown.x,", ").concat(this.deferredDown.y,")")),console.debug("await page.mouse.down()"),this.deferredDown=null):console.debug("await editor.canvasMouseMove(".concat(e.offsetX,", ").concat(e.offsetY,")")),this.lastMoveAt=Date.now()},this.onPointerDown=e=>{this.deferredDown={x:e.offsetX,y:e.offsetY},this.isDown=!0},this.onPointerUp=e=>{if(this.isDown=!1,this.deferredDown){console.debug("await editor.canvasMouseClick(".concat(e.offsetX,", ").concat(e.offsetY,")"));return}this.logMove(e),console.debug("await page.mouse.up()")},this.onPointerMove=e=>{this.isDown&&(!this.lastMoveAt||Date.now()-this.lastMoveAt>this.moveLogPeriod)&&this.logMove(e)}}}},39975:function(e,t,i){i.d(t,{IW:function(){return y},Ql:function(){return g},id:function(){return m}});var n=i(2784),s=i(69385),o=i(8554),r=i(19204),a=i(21571),l=i(44574),c=i(20814),h=i(42180),u=i(16355);i(34999);var d=i(2374),f=i(35200);let p=e=>{let t={[r.$WI.Community]:["filter"],[r.$WI.History]:[],[r.$WI.Liked]:[],[r.$WI.AllInStyle]:["filter"],[r.$WI.BestInStyle]:["filter"],[r.$WI.CommunityRandom]:["filter"],[r.$WI.CommunityRaw]:["filter"],[r.$WI.Styles]:["filter"]}[e.type]||[],i={...e};return t.forEach(e=>{delete i[e]}),i},g=e=>{let{payload:t,onSuccess:i,enabled:s=!0}=e,{defaultApi:o}=(0,u.hU)(),{workspaceId:r}=(0,l.a)(),a=(0,n.useMemo)(()=>(0,f.AZ)([d.VJ,t,r||""]),[t,r]),{data:h,isLoading:p,hasNextPage:g,fetchNextPage:y,refetch:m}=(0,c.N)({initialPageParam:0,queryKey:a,refetchOnMount:!1,queryFn:async e=>{let{pageParam:n}=e,s=await o.listRecraftImages({...t,imageTypes:(0,f.Up)(t.imageTypes),transformTypes:(0,f.Up)(t.transformTypes),limit:d.tK,offset:n,workspaceId:r});return null==i||i(),s},getNextPageParam:(e,t)=>e.recraftImages.length>=d.tK?t.length*d.tK:void 0,enabled:s}),v=(null==h?void 0:h.pages.reduce((e,t)=>[...e,...t.recraftImages],[]))||[];return{isLoading:p,hasNextPage:g,fetchNextPage:y,data:h,images:v,refetch:m,isEmptyResult:!p&&!v.length}},y=e=>{let{payload:t,onSuccess:i}=e,{isSearchAvailable:n}=(0,a.g)(),[r,{setAll:l}]=(0,s.Z)((0,f.l$)(n?t:p(t)));(0,o.Z)(()=>l((0,f.l$)(n?t:p(t))),d.Y2,[t,n]);let{isLoading:c,hasNextPage:h,fetchNextPage:u,data:y,images:m,refetch:v,isEmptyResult:w}=g({payload:r,onSuccess:i});return{isLoading:c,hasNextPage:h,fetchNextPage:u,data:y,images:m,refetch:v,isEmptyResult:w}},m=function(){let{enabled:e=!0,imageId:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{defaultApi:i}=(0,u.hU)();return(0,h.a)({queryKey:(0,f.AZ)([d.Wb,t]),queryFn:()=>t?i.getImageDetails({imageId:t}):null,enabled:!!t&&e,retry:!1,refetchOnMount:!1})}},52266:function(e,t,i){i.d(t,{a:function(){return l}});var n=i(65953),s=i(20672),o=i(65503),r=i(79768),a=i(89629);class l{get name(){return(0,s.H)(this.engine.t,"actions.".concat(this.id))}get tooltip(){return{id:this.id,data:null}}subscribe(){var e;!this.hotkeyCommand||(null===(e=this.engine.shortcutManager.getByCommand(this.hotkeyCommand))||void 0===e?void 0:e.doNotSubscribeToKeydown)||(document.addEventListener("keydown",this.handleKeyDown),this.cleanup.push(()=>{document.removeEventListener("keydown",this.handleKeyDown)}))}unsubscribe(){for(let e of this.cleanup)e()}addHotkeyListener(e){return this.hotkeyListeners.push(e),()=>{let t=this.hotkeyListeners.findIndex(t=>t===e);-1!==t&&this.hotkeyListeners.splice(t,1)}}constructor({id:e,group:t,hotkeyCommand:i,togglable:s,icon:l,notificationActions:c,engine:h}){this.hotkeyListeners=[],this.cleanup=[],this.handleKeyDown=e=>{if(!(!this.hotkeyCommand||(0,r.Qz)(e)||(0,r.xW)())&&this.checkIsAvailable()&&this.engine.shortcutManager.getShortcutCommands(e).includes(this.hotkeyCommand)){(0,a.fs)()&&(0,n.K)(e),e.preventDefault(),(0,o.L9)("ActionCommandKeyboard",{command:this.hotkeyCommand}),this.dispatch(),this.hotkeyListeners.forEach(e=>e()),e.stopImmediatePropagation();return}},this.checkIsAvailable=()=>(!this.engine.isReadOnly||!!this.isAvailableInReadOnly)&&this.doCheckIsAvailable(),this.doCheckIsAvailable=()=>!0,this.checkIsActive=()=>!1,this.checkIsDisabled=()=>!1,this.checkIsLoading=()=>!1,this.dispatcher=async e=>{},this.dispatch=async e=>{await this.dispatcher(e),(0,o.L9)("Action",{action:this.id,payload:e})},this.id=e,this.icon=null!=l?l:this.id,this.group=t,this.hotkeyCommand=i,this.togglable=null!=s&&s,this.notificationActions=c,this.engine=h}}},28563:function(e,t,i){i.d(t,{Dm:function(){return v},Fy:function(){return g},uf:function(){return p}});var n=i(20119),s=i(52475),o=i(83101),r=i(19204),a=i(70624),l=i(41376),c=i(72918),h=i(44954),u=i(64169),d=i(55551),f=i(52266);let p=[a.Jq.Gemini25FlashImage],g=(e,t)=>e.reduce((e,i)=>{let[n,s]=i.split(c.QA).map(e=>parseInt(e)),o=Math.abs(t.w/t.h-n/s);return e.diff>o?{diff:o,aspect:i}:e},{diff:1/0,aspect:r.oM5.AspectRatio1x1}).aspect;var y=new WeakMap;class m extends f.a{calculateAspect(e,t,i){let n=this.getTargetAspect(e);if(!n)return;let s=new i(t);return(0,h.RH)(n,s)}get aspect(){let e=(0,n._)(this,y).call(this);if(!e)return c.lK;let t=this.engine.object[e.type].getReader(e.id);return t?g(this.availableAspects()||[],(0,u.Sp)(t.getAspectableAreaSize(),t.getAspectableAreaTransform())):c.lK}get tooltip(){return{id:this.id,data:{title:this.engine.t("tooltip.aspectRatio.title"),text:this.engine.t("tooltip.aspectRatio.description")}}}constructor(e){super({id:l.X.ASPECT_RATIO,group:l.T.LAYER,...e}),(0,s._)(this,y,{writable:!0,value:void 0}),this.isAvailableInReadOnly=!0,this.availableAspects=()=>{var e;let t=(0,n._)(this,y).call(this);if(!t)return null;let i=null===(e=this.engine.object[t.type].getReader(t.id))||void 0===e?void 0:e.getPrompt();return!(null==i?void 0:i.image_type)||i.transformModel&&p.includes(i.transformModel)?null:d.UH},this.doCheckIsAvailable=()=>{let e=this.availableAspects();return!!(null==e?void 0:e.length)},this.checkIsActive=()=>{var e,t;return this.doCheckIsAvailable()&&(null===(t=this.engine.selectionLayer)||void 0===t?void 0:null===(e=t.get("prompt"))||void 0===e?void 0:e.image_to_image_strength)!==void 0},this.dispatcher=async()=>{this.engine.isReadOnly||(this.checkIsActive()?this.engine.layer.updatePrompt({},["image_to_image_strength"]):this.setAspect(c.lK))},(0,o._)(this,y,()=>{let e=this.engine.selection.single;return(null==e?void 0:e.type)==="layers"||(null==e?void 0:e.type)==="frames"||(null==e?void 0:e.type)==="mockups"||(null==e?void 0:e.type)==="imageSets"?{type:e.type,id:e.id}:null}),this.getTargetAspect=e=>{if((this.availableAspects()||[]).some(t=>t===e))return e.split(c.QA).map(e=>parseInt(e))},this.setAspect=e=>{let t=(0,n._)(this,y).call(this);if(!t)return;let i=this.getTargetAspect(e);if(!i)return;let s=this.engine.object[t.type].getWriter(t.id);s&&s.setAspect(i)}}}let v=e=>new m(e)},44954:function(e,t,i){i.d(t,{RH:function(){return o},kd:function(){return s},q9:function(){return r}});var n=i(64169);let s=(e,t,i,s)=>{let o;if(s){let t=(0,n.Sp)(s,i);if(t.w*e[1]<t.h*e[0]){let i=t.w/t.h*s.h*(e[1]/e[0]);o={x:0,y:-(i-s.h)/2,w:s.w,h:i}}else{let i=t.h/t.w*s.w*(e[0]/e[1]);o={x:-(i-s.w)/2,y:0,w:i,h:s.h}}}else{let s,r;let a=(0,n.Sp)(t,i),l=Math.min(a.w,a.h);e[0]<=e[1]?(s=t.w/a.w*l,r=t.h/a.h*l*(e[1]/e[0])):(s=t.w/a.w*l*(e[0]/e[1]),r=t.h/a.h*l),o={x:t.x+t.w/2-s/2,w:s,y:t.y+t.h/2-r/2,h:r}}return o},o=(e,t)=>s(e,t.getCropBbox(),t.getTransform(),t.getContentSize()),r=(e,t)=>{let i=o(e,t.toReader());t.setCropBbox(i)}},98489:function(e,t,i){i.d(t,{LR:function(){return r},RT:function(){return s},SU:function(){return o}});var n=i(85976);let s=e=>{switch(e){case n.T2.Jpeg:return".jpg";case n.T2.Lottie:return".json";case n.T2.Png:return".png";case n.T2.Svg:return".svg";case n.T2.TiffCMYK:return".tiff";case n.T2.PdfAuto:case n.T2.PdfRaster:case n.T2.PdfVector:return".pdf";default:return""}},o=e=>e.replace(/[^a-zA-Z0-9]/gi,"-").toLowerCase().slice(0,50),r=async e=>{let{filename:t,fileUrl:i,fetchBlob:n,format:o}=e,r=s(o),a=document.createElement("a"),l=null;try{if(n){let e=await n();l=i=URL.createObjectURL(e),a.target="_blank",a.rel="noopener noreferrer"}if(!i)return;document.body.append(a),a.download="".concat(t).concat(r),a.href=i,a.click()}finally{if(l){let e=l;setTimeout(()=>{URL.revokeObjectURL(e)},5e3)}a.remove()}}}}]);