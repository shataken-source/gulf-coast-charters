try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="54671696-c6d4-4b53-a9ea-560d1b00e914",e._sentryDebugIdIdentifier="sentry-dbid-54671696-c6d4-4b53-a9ea-560d1b00e914")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8714],{52599:function(e,t,n){var r,s=n(2784);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return s.createElement("svg",i({width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M2 4.50003L6 8.5L10 4.5",stroke:"currentColor",strokeWidth:1.2,strokeLinecap:"round",strokeLinejoin:"round"})))}},81651:function(e,t,n){var r,s=n(2784);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return s.createElement("svg",i({width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M2 7.49997L6 3.5L10 7.5",stroke:"currentColor",strokeWidth:1.2,strokeLinecap:"round",strokeLinejoin:"round"})))}},82755:function(e,t,n){var r,s=n(2784);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return s.createElement("svg",i({width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M2.5 2.5L9.5 9.5M9.5 2.5L2.5 9.5",stroke:"currentColor",strokeWidth:1.2,strokeLinecap:"round"})))}},76992:function(e,t,n){var r,s,i=n(2784);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return i.createElement("svg",o({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=i.createElement("g",{clipPath:"url(#clip0_40_1766)"},i.createElement("path",{d:"M8 4.2002C8.54993 4.2002 8.99978 4.19979 9.36328 4.22949C9.73352 4.2598 10.0685 4.32426 10.3809 4.4834C10.8697 4.73262 11.2674 5.13026 11.5166 5.61914C11.6758 5.93168 11.7412 6.26717 11.7715 6.6377C11.8012 7.00119 11.8008 7.45013 11.8008 8V11.3994C11.8008 11.9494 11.8012 12.3991 11.7715 12.7627C11.7412 13.133 11.6757 13.4679 11.5166 13.7803C11.2674 14.2692 10.8697 14.6668 10.3809 14.916C10.0685 15.0752 9.73353 15.1406 9.36328 15.1709C8.99978 15.2006 8.54993 15.2002 8 15.2002H4.60059C4.05086 15.2002 3.60174 15.2005 3.23828 15.1709C2.86779 15.1406 2.53223 15.0752 2.21973 14.916C1.73075 14.6668 1.3332 14.2693 1.08398 13.7803C0.924778 13.4678 0.860374 13.1331 0.830078 12.7627C0.800384 12.3991 0.800782 11.9495 0.800782 11.3994V8C0.800781 7.45009 0.8004 7.0012 0.830078 6.6377C0.860366 6.26718 0.924745 5.93167 1.08398 5.61914C1.33322 5.13033 1.73087 4.73257 2.21973 4.4834C2.53219 4.3243 2.86786 4.25976 3.23828 4.22949C3.60174 4.19985 4.05084 4.2002 4.60059 4.2002H8ZM4.60059 5.39941C4.03114 5.39941 3.63923 5.40008 3.33594 5.42481C3.03994 5.44899 2.87984 5.49414 2.76465 5.55273C2.50155 5.68686 2.28752 5.901 2.15332 6.16406C2.09462 6.27926 2.04961 6.4391 2.02539 6.73535C2.00063 7.03868 2 7.43034 2 8V11.3994C2 11.969 2.00065 12.3608 2.02539 12.6641C2.04961 12.9605 2.09461 13.1201 2.15332 13.2354C2.28755 13.4987 2.50127 13.7135 2.76465 13.8477C2.87985 13.9063 3.03985 13.9504 3.33594 13.9746C3.63924 13.9993 4.03111 14 4.60059 14H8C8.56939 14 8.9614 13.9994 9.26465 13.9746C9.56055 13.9504 9.72079 13.9063 9.83594 13.8477C10.0992 13.7134 10.3141 13.4986 10.4482 13.2354C10.5068 13.1202 10.551 12.96 10.5752 12.6641C10.5999 12.3608 10.6006 11.9689 10.6006 11.3994V8C10.6006 7.43034 10.6 7.03868 10.5752 6.73535C10.551 6.43914 10.5069 6.27927 10.4482 6.16406C10.3141 5.90077 10.0992 5.68697 9.83594 5.55273C9.72077 5.49405 9.56075 5.44903 9.26465 5.42481C8.9614 5.40006 8.56938 5.39942 8 5.39941H4.60059ZM11.3994 0.800782C11.9496 0.800782 12.3991 0.800371 12.7627 0.830078C13.1331 0.860376 13.4678 0.924783 13.7803 1.08398C14.2692 1.3332 14.6668 1.73079 14.916 2.21973C15.0752 2.53223 15.1406 2.8678 15.1709 3.23828C15.2005 3.60175 15.2002 4.05082 15.2002 4.60059V8C15.2002 8.54997 15.2006 8.99976 15.1709 9.36328C15.1406 9.73357 15.0752 10.0685 14.916 10.3809C14.6668 10.8697 14.2692 11.2674 13.7803 11.5166C13.4778 11.6707 13.1542 11.7351 12.7979 11.7666C12.7982 11.6467 12.8008 11.5239 12.8008 11.3994V10.5596C13.0119 10.534 13.1393 10.4971 13.2354 10.4482C13.4987 10.3141 13.7134 10.0992 13.8477 9.83594C13.9063 9.72077 13.9504 9.56062 13.9746 9.26465C13.9994 8.96138 14 8.56944 14 8V4.60059C14 4.03106 13.9993 3.63925 13.9746 3.33594C13.9504 3.03986 13.9063 2.87985 13.8477 2.76465C13.7135 2.50131 13.4987 2.28755 13.2354 2.15332C13.1201 2.09461 12.9604 2.04961 12.6641 2.02539C12.3607 2.00064 11.9691 2 11.3994 2H8C7.43024 2 7.03871 2.00063 6.73535 2.02539C6.43897 2.04961 6.27929 2.09461 6.16406 2.15332C5.90092 2.28751 5.68689 2.50148 5.55273 2.76465C5.50375 2.8609 5.46521 2.98822 5.43945 3.2002H4.60059C4.47616 3.2002 4.35324 3.20088 4.2334 3.20117C4.26491 2.84524 4.32953 2.52186 4.4834 2.21973C4.7326 1.73081 5.13024 1.33322 5.61914 1.08398C5.93172 0.924715 6.2671 0.860359 6.6377 0.830078C7.00125 0.800396 7.45 0.800782 8 0.800782H11.3994Z",fill:"currentColor"}))),s||(s=i.createElement("defs",null,i.createElement("clipPath",{id:"clip0_40_1766"},i.createElement("rect",{width:16,height:16,fill:"white"})))))}},60485:function(e,t,n){var r,s=n(2784);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return s.createElement("svg",i({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M8 0C9.36872 0 10.4879 1.05783 10.5898 2.40039H15C15.3314 2.40039 15.5996 2.66863 15.5996 3C15.5996 3.33137 15.3314 3.59961 15 3.59961H13.9756L13.5977 9.72754C13.5408 10.6473 13.4959 11.3796 13.4033 11.9639C13.3092 12.5577 13.1572 13.0581 12.8516 13.4971C12.5736 13.8959 12.2159 14.2331 11.8008 14.4863C11.3442 14.7648 10.8352 14.885 10.2373 14.9424C9.64912 14.9988 8.91621 14.999 7.99609 14.999C7.07459 14.999 6.33997 14.9989 5.75098 14.9424C5.15255 14.8849 4.64334 14.7642 4.18652 14.4854C3.77117 14.2317 3.41263 13.8938 3.13477 13.4941C2.82928 13.0546 2.67834 12.5535 2.58496 11.959C2.49309 11.3739 2.45006 10.6407 2.39453 9.71973L2.02441 3.59961H1C0.668629 3.59961 0.400391 3.33137 0.400391 3C0.400391 2.66863 0.668629 2.40039 1 2.40039H5.41016C5.51215 1.05783 6.63128 0 8 0ZM3.22461 3.59961L3.58887 9.64746C3.64581 10.5917 3.68665 11.2581 3.76758 11.7734C3.84697 12.2788 3.95767 12.5796 4.11816 12.8105V12.8115C4.30122 13.0747 4.53729 13.297 4.81055 13.4639L4.9043 13.5166C5.13048 13.6328 5.42154 13.7083 5.86621 13.751C6.38467 13.8007 7.05158 13.8018 7.99609 13.8018C8.9395 13.8018 9.60526 13.8007 10.123 13.751C10.631 13.7022 10.9381 13.611 11.1777 13.4648C11.451 13.2982 11.6869 13.0755 11.8701 12.8125C12.0306 12.5818 12.1407 12.2809 12.2207 11.7764C12.3022 11.2618 12.3441 10.5962 12.4023 9.65332L12.7754 3.59961H3.22461ZM6.2998 5.80078C6.63118 5.80078 6.89941 6.06902 6.89941 6.40039V10.6006C6.8991 10.9317 6.63098 11.2002 6.2998 11.2002C5.96863 11.2002 5.70051 10.9317 5.7002 10.6006V6.40039C5.7002 6.06902 5.96843 5.80078 6.2998 5.80078ZM9.7002 5.80078C10.0315 5.80089 10.2998 6.06909 10.2998 6.40039V10.6006C10.2995 10.9316 10.0313 11.2001 9.7002 11.2002C9.36902 11.2002 9.09993 10.9317 9.09961 10.6006V6.40039C9.09961 6.06902 9.36882 5.80078 9.7002 5.80078ZM8 1.19922C7.29464 1.19922 6.71226 1.72179 6.61523 2.40039H9.38477C9.28774 1.72179 8.70536 1.19922 8 1.19922Z",fill:"currentColor"})))}},47973:function(e,t,n){var r,s=n(2784);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return s.createElement("svg",i({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=s.createElement("path",{d:"M7.1211 1.01172C7.39439 1.06763 7.6004 1.30983 7.60059 1.59961C7.60059 1.88951 7.39444 2.1315 7.1211 2.1875L7.00098 2.19922H6.72071C5.8152 2.19922 5.17136 2.20014 4.66797 2.24121C4.17184 2.28175 3.86361 2.35945 3.62012 2.4834C3.13126 2.73255 2.73363 3.13035 2.48438 3.61914C2.3603 3.86265 2.28277 4.17075 2.24219 4.66699C2.20108 5.17039 2.2002 5.81412 2.2002 6.71973V9.2793C2.2002 10.1848 2.20112 10.8286 2.24219 11.332C2.28275 11.8285 2.3603 12.1363 2.48438 12.3799C2.73365 12.8691 3.13093 13.2673 3.62012 13.5166C3.86365 13.6406 4.17167 13.7173 4.66797 13.7578C5.17137 13.7989 5.81514 13.7998 6.72071 13.7998H9.28028C10.1857 13.7998 10.8297 13.7989 11.333 13.7578C11.8291 13.7172 12.1374 13.6406 12.3809 13.5166C12.8698 13.2673 13.2684 12.8689 13.5176 12.3799C13.6415 12.1364 13.7183 11.828 13.7588 11.332C13.7999 10.8287 13.8008 10.1848 13.8008 9.2793V9C13.801 8.66888 14.0692 8.39952 14.4004 8.39942C14.7314 8.39968 15.0008 8.66898 15.001 9V9.2793C15.001 10.1653 15.0011 10.867 14.9551 11.4307C14.9085 12.001 14.8104 12.4841 14.5859 12.9248C14.2217 13.6395 13.6404 14.2207 12.9258 14.585C12.4851 14.8095 12.0019 14.9074 11.4316 14.9541C10.868 15.0002 10.1662 15 9.28028 15H6.72071C5.83494 15 5.13389 15.0001 4.57031 14.9541C3.9997 14.9075 3.51608 14.8096 3.0752 14.585C2.3604 14.2207 1.7793 13.6396 1.41504 12.9248C1.19047 12.484 1.09254 12.0011 1.0459 11.4307C0.999874 10.867 1.00098 10.1653 1.00098 9.2793V6.71973C1.00098 5.83392 0.99988 5.1329 1.0459 4.56934C1.09254 3.99882 1.19043 3.51505 1.41504 3.07422C1.77934 2.35967 2.36058 1.77826 3.0752 1.41406C3.51599 1.18959 3.99984 1.09153 4.57031 1.04492C5.13387 0.99894 5.83498 1 6.72071 1H7.00098L7.1211 1.01172ZM10.9229 1.79395C11.8297 0.88723 13.2992 0.887213 14.2061 1.79395C15.1129 2.7008 15.1128 4.17124 14.2061 5.07813L10.1436 9.14063C9.41016 9.87396 8.47411 10.3713 7.45606 10.5693L5.81446 10.8887C5.61872 10.9267 5.41736 10.8646 5.27637 10.7236C5.13545 10.5826 5.07336 10.3812 5.11133 10.1855L5.43067 8.54395C5.62869 7.52593 6.12607 6.58982 6.85938 5.85645L10.9229 1.79395ZM13.3584 2.6416C12.9202 2.2035 12.2087 2.20352 11.7705 2.6416L7.70801 6.70508C7.14384 7.26931 6.76082 7.98926 6.6084 8.77246L6.45801 9.54102L7.22754 9.3916C8.0108 9.2392 8.73066 8.8562 9.29492 8.29199L13.3584 4.22949C13.7965 3.79123 13.7966 3.07981 13.3584 2.6416Z",fill:"currentColor"})))}},8710:function(e,t,n){n.d(t,{Ly:function(){return C},NB:function(){return g},O1:function(){return w},RH:function(){return x},SD:function(){return y},SP:function(){return p},Vw:function(){return b},Xo:function(){return v},xK:function(){return m}});var r=n(52322),s=n(2784),i=n(51021),o=n(96938),l=n(42444),a=n(22877);let u=(0,s.createContext)(null),c=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useUserPresenceContext must be used within a UserPresenceContext");return e},d=()=>{let e=(0,s.useRef)(new Map),t=(0,s.useRef)(new Set),n=(0,s.useRef)(new Set),r=(0,s.useRef)(new Map),i=(0,l.S)(e=>e.selection),o=(0,s.useRef)(new Set);(0,s.useEffect)(()=>{let s=o.current,l=new Set((null!=i?i:[]).map(e=>e.id));if(!(1===s.size&&1===l.size&&s.values().next().value===l.values().next().value)){if(1===s.size){let e=(0,a.nn)(s.values().next().value),t=r.current.get(e);if(t)for(let e of t)e(!1)}if(1===l.size){let e=(0,a.nn)(l.values().next().value),t=r.current.get(e);if(t)for(let e of t)e(!0)}}for(let t of l){if(s.has(t))continue;let n=e.current.get(t);if(n)for(let e of n)e(!0)}for(let t of s){if(l.has(t))continue;let n=e.current.get(t);if(n)for(let e of n)e(!1)}if(s.size!==l.size)for(let e of t.current)e(l.size);for(let e of n.current)e(i);o.current=l},[i]);let u=(0,s.useCallback)((t,n)=>{let r=e.current.get(t.id);return r||(r=new Set,e.current.set(t.id,r)),r.add(n),()=>{let r=e.current.get(t.id);null==r||r.delete(n),(null==r?void 0:r.size)||e.current.delete(t.id)}},[]),c=(0,s.useCallback)(e=>(t.current.add(e),()=>t.current.delete(e)),[]),d=(0,s.useCallback)(e=>(n.current.add(e),()=>n.current.delete(e)),[]);return{subscribeToIsSelected:u,subscribeToSelectionSize:c,subscribeToIsSingleSelection:(0,s.useCallback)((e,t)=>{let n=r.current.get(e.id);return n||(n=new Set,r.current.set(e.id,n)),n.add(t),()=>{let n=r.current.get(e.id);null==n||n.delete(t),(null==n?void 0:n.size)||r.current.delete(e.id)}},[]),subscribeToSelectionValue:d}},h=()=>{let e=(0,s.useRef)(new Set),t=(0,s.useRef)(new Set),n=(0,o.EP)(),{activeTool:r,selectionMaskMode:i}=(0,l.S)(e=>({activeTool:n.activeTool,selectionMaskMode:n.selectionMaskMode}));return(0,s.useEffect)(()=>{for(let t of e.current)t(r)},[r]),(0,s.useEffect)(()=>{for(let e of t.current)e(i)},[i]),{subscribeToActiveTool:(0,s.useCallback)(t=>(e.current.add(t),()=>e.current.delete(t)),[]),subscribeToSelectionMaskMode:(0,s.useCallback)(e=>(t.current.add(e),()=>t.current.delete(e)),[])}},f=()=>{let e=(0,s.useRef)({start:new Map,update:new Map,finish:new Map,cancel:new Map}),t=(0,s.useCallback)((t,n,r)=>{let s=[];for(let i of null!=r?r:["start","update","finish","cancel"])for(let r of t){let t=e.current[i].get(r);t||(t=new Set,e.current[i].set(r,t)),t.add(n),s.push(()=>{t.delete(n),0===t.size&&e.current[i].delete(r)})}return()=>s.forEach(e=>e())},[]),n=(0,o.EP)(),r=(0,s.useCallback)(t=>{let r=n.session.session;if(r)for(let n of r.getTags()){var s;for(let i of null!==(s=e.current[t].get(n))&&void 0!==s?s:[])i(r,t)}},[]);return(0,s.useEffect)(()=>{let e=["start","update","finish","cancel"].map(e=>n.session.subscribe(()=>r(e),[e]));return()=>e.forEach(e=>e())},[]),{subscribeToSessionWithTag:t}},C=e=>{let{children:t}=e,n=(0,s.useRef)({...d(),...h(),...f()});return(0,r.jsx)(u.Provider,{value:n.current,children:t})},p=()=>{let e=(0,o.EP)(),{subscribeToSelectionValue:t}=c(),[n,r]=(0,s.useState)(e.selection.value);return(0,s.useEffect)(()=>t(r),[t,r]),n},b=e=>{let t=(0,o.EP)(),{subscribeToIsSelected:n}=c(),[r,i]=(0,s.useState)(t.selection.isSelected(e));return(0,s.useEffect)(()=>n(e,i),[e.id,e.type,n,i]),r},g=()=>{let e=(0,o.EP)(),{subscribeToSelectionSize:t}=c(),[n,r]=(0,s.useState)(e.selection.length);return(0,s.useEffect)(()=>t(r),[t,r]),n},v=e=>{let t=(0,o.EP)(),{subscribeToIsSingleSelection:n}=c(),[r,i]=(0,s.useState)(t.selection.isSingle&&t.selection.isSelected(e));return(0,s.useEffect)(()=>n(e,i),[e.id,e.type,n,i]),r},m=()=>{let e=(0,o.EP)(),{subscribeToActiveTool:t}=c(),[n,r]=(0,s.useState)(e.activeTool);return(0,s.useEffect)(()=>t(r),[t]),n},x=()=>{let e=(0,o.EP)(),{subscribeToSelectionMaskMode:t}=c(),[n,r]=(0,s.useState)(e.selectionMaskMode);return(0,s.useEffect)(()=>t(r),[t]),n},w=(e,t,n,r)=>{let{subscribeToSessionWithTag:i}=c(),[o,l]=(0,s.useState)(null),a=(0,s.useRef)({});return(0,s.useEffect)(()=>i(e,(e,n)=>l(t(e,n)),n),[a,i,a,...e,a,...null!=r?r:[]]),o},y=()=>{let[e,t]=(0,s.useState)(!1);return w(["any"],(e,n)=>t(!(0,i.p)(n)),["start","finish","cancel"]),e}},51021:function(e,t,n){n.d(t,{I:function(){return u},p:function(){return a}});var r=n(62175),s=n(79768),i=n(71698),o=n(18614),l=n(49628);let a=e=>"finish"===e||"cancel"===e;class u{subscribe(e,t){let n=[...null!=t?t:["start","update","finish","cancel"]];for(let t of n)this.subscribers[t].add(e);return()=>n.forEach(t=>this.subscribers[t].delete(e))}notify(e){for(let t of this.subscribers[e])t()}hasRunningSession(){return!!this.session}hasRunningBrushSession(){return!!this.session&&(this.session instanceof l.t||this.session instanceof i.J||this.session instanceof o.V)}start(e,t){this.hasRunningSession()||(this.session=t,this.session.start(e),this.engine.history.pause(),this.notify("start"))}update(e){this.hasRunningSession()&&this.session&&(this.session.update(e),this.notify("update"))}finish(e){this.hasRunningSession()&&this.session&&(this.session.complete(e),this.notify("finish"),this.session.dispose(),this.session=void 0,this.engine.history.resume())}cancel(e){this.hasRunningSession()&&this.session&&(this.session.cancel(e),this.notify("cancel"),this.session.dispose(),this.session=void 0,this.engine.history.resume())}constructor(e){this.engine=e,this.subscribers={start:new Set,update:new Set,finish:new Set,cancel:new Set},this.onPointerDown=e=>(this.lastPointerCoords=e.p,e.e.button===s.iu?this.engine.tools[r.UA.Grab].onPointerDown(e):this.engine.tools[this.engine.activeTool].onPointerDown(e),this.hasRunningSession()),this.onPointerMove=e=>{this.lastPointerCoords=e.p,this.update(e)},this.onPointerUp=e=>{this.lastPointerCoords=e.p,this.finish(e)},this.onPointerCancel=e=>{this.cancel(e)},this.onPointerOut=e=>{this.cancel(e)}}}},71698:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(94745),s=n(64169),i=n(22877),o=n(94526),l=n(3418);class a extends l.x{start(e){this.lastPosition=e.p.canvas,this.update(e)}complete(e){this.update(e)}update(e){for(let[t,n]of this.brushBboxes.entries()){let r=e.p.canvas,l=(0,o.SO)(n.transform),a=(0,s.I1)(n.transform,n.bbox);if(!(0,s.VY)((0,s.UG)(a,this.eraserSize),r))continue;let u=(0,i.nn)(this.brushStrokes.get(t));(0,s.jw)(u.stroke,(u.size+this.eraserSize)/2,(0,o.nn)(l,r),(0,o.nn)(l,(0,i.nn)(this.lastPosition)))&&(this.brushBboxes.delete(t),this.engine.brushStroke.delete(t))}this.lastPosition=e.p.canvas}constructor(e){var t;for(let n of(super(e),this.brushBboxes=new Map,this.brushStrokes=e.storage.toImmutable().brushStrokes,this.eraserSize=(0,s.Ed)(e.presence.viewport,null!==(t=e.presence.brushSize)&&void 0!==t?t:r.po),this.brushStrokes.keys()))this.brushBboxes.set(n,(0,i.nn)(this.engine.shapeObserver.getShape(n)))}}},18614:function(e,t,n){n.d(t,{V:function(){return a}});var r=n(94745),s=n(64169),i=n(2113),o=n(49628),l=n(94019);class a extends o.t{start(e){var t;this.frameIdUnder=null!==(t=this.hitBoxes.findFrameUnderPoint(e.p.canvas))&&void 0!==t?t:void 0,super.start(e)}constructor(e){var t,n;super(e,null,e=>e,{size:(0,s.Ed)(e.presence.viewport,null!==(t=e.presence.brushSize)&&void 0!==t?t:r.po),color:null!==(n=e.presence.brushColor)&&void 0!==n?n:i.O9.black,stroke:[]},null,e=>{var t;let{size:n,stroke:r}=e;this.engine.brushStroke.create(null!==(t=this.engine.presence.brushColor)&&void 0!==t?t:i.O9.black,r,n,this.frameIdUnder)}),this.engine=e,this.hitBoxes=new l.hF(e)}}},3418:function(e,t,n){n.d(t,{x:function(){return r}});class r{start(e){}update(e){}complete(e){}cancel(e){}dispose(){}constructor(e){this.tags=new Set(["any"]),this.getTags=()=>Array.from(this.tags.values()),this.addTag=e=>{this.tags.add(e)},this.engine=e}}},49628:function(e,t,n){n.d(t,{Z:function(){return l},t:function(){return o}});var r=n(79768),s=n(94526),i=n(3418);class o extends i.x{strokeSnapshot(){return this.strokeSnapshotCache.stroke.length!==this.strokePath.length&&(this.strokeSnapshotCache={...this.brush,stroke:[...this.strokePath]}),this.strokeSnapshotCache}start(e){this.lastStrokeEnd&&(0,r.wE)(e.e)&&this.strokePath.push(this.lastStrokeEnd),this.update(e,!0)}update(e,t){let n=e.p.canvas;if(t||(this.clickAction=null),this.startPoint){let t=(0,s.cb)(n,this.startPoint);this.alignment||0===t.x&&0===t.y||(this.alignment=Math.abs(t.x)<Math.abs(t.y)?"vertical":"horizontal"),this.alignment&&(0,r.wE)(e.e)&&(t["vertical"===this.alignment?"x":"y"]=0,n=(0,s.IH)(this.startPoint,t))}else this.startPoint=n;this.strokePath.push(this.toLocalCoords(n))}finish(e){var t,n;!(e&&(null===(t=this.clickAction)||void 0===t?void 0:t.call(this,e.p.canvas)))&&(e&&this.update(e),this.strokePath&&(null===(n=this.onComplete)||void 0===n||n.call(this,{...this.brush,stroke:this.strokePath})))}cancel(){this.finish()}complete(e){this.finish(e)}constructor(e,t,n,r,s,i,o){super(e),this.objectId=t,this.toLocalCoords=n,this.brush=r,this.clickAction=s,this.onComplete=i,this.lastStrokeEnd=o,this.strokePath=[],this.addTag("brush"),this.strokeSnapshotCache={...r,stroke:[]}}}class l extends o{}},94019:function(e,t,n){n.d(t,{RG:function(){return o},hF:function(){return l},xn:function(){return i}});var r=n(64169),s=n(94526);let i=e=>{let t=[];for(let[n,r]of Object.entries(e.object))for(let[e,s]of r.all.entries()){if(s.get("frameId")||s.get("hidden"))continue;let i=r.getHitboxById(e);i&&t.push({type:n,...i})}return t.sort((e,t)=>t.zIndex-e.zIndex),t},o=e=>{let t=null;if(!e.length)return null;for(let n of e){let{transform:e,bbox:s}=n;t=t?(0,r.FP)(t,(0,r.I1)(e,s)):(0,r.I1)(e,s)}return t};class l{findHitBoxUnderPoint(e,t,n){for(let s of this.boxes)if((null==n||!n.has(s.id))&&(0,r.mR)(s.shape.bbox,s.inversedTransform,e)){if(void 0!==t.find(e=>e===s.type))return{id:s.id,type:s.type};break}return null}findFrameUnderPoint(e,t){var n;return(null===(n=this.findHitBoxUnderPoint(e,["frames"],t))||void 0===n?void 0:n.id)||null}isStickyParentUnderPoint(e){let t=this.findHitBoxUnderPoint(e,["frames","mockups","imageSets"]);return!((null==t?void 0:t.type)!=="imageSets")}findAllObjectsUnderBbox(e){return this.boxes.filter(t=>(0,r.UL)(e,(0,r.I1)(t.shape.transform,t.shape.bbox))&&(0,r.UL)((0,r.I1)(t.inversedTransform||s.gD,e),t.shape.bbox))}constructor(e){this.boxes=[],this.boxes=i(e)}}},60603:function(e,t,n){n.d(t,{Xw:function(){return h},Ym:function(){return c},tG:function(){return d}});var r=n(55230),s=n(2784),i=n(2180),o=n(62175),l=n(8710),a=n(65503),u=n(96938);let c=()=>{let e=(0,u.EP)();return(0,i.Z)(e.tools.ColorPicker.colorPickerState)},d=(e,t)=>{let n=(0,u.EP)(),i=(0,l.xK)(),[c,d]=(0,s.useState)(i);(0,s.useEffect)(()=>{i!==o.UA.ColorPicker&&d(i)},[i]);let h=n.activeTool===o.UA.ColorPicker,f=(0,s.useCallback)(e=>{n.activeTool===o.UA.ColorPicker&&(n.setActiveTool({activeTool:e}),n.tools.ColorPicker.unsubscribe())},[n]),C=(0,s.useCallback)(()=>{f(c)},[c,f]),p=(0,s.useRef)(null),b=(0,s.useCallback)(()=>{p.current=null,n.tools.ColorPicker.subscribe(n=>{let s=(0,r.Vi)(n).toHex();s!==p.current&&(p.current=s,e(n),(0,a.L9)("ColorPickerOnCanvas",{source:t}))},()=>f(c)),n.setActiveTool({activeTool:o.UA.ColorPicker})},[n,e,t,f,c]),g=(0,s.useCallback)(()=>{h?C():b()},[h,b,C]);return{startColorPicker:b,stopColorPicker:C,isColorPickerOnCanvasActive:h,handleColorPickerClick:g}},h=e=>{let t=(0,u.oF)();return{handleInteractOutside:(0,s.useCallback)(n=>{(null==t?void 0:t.activeTool)===o.UA.ColorPicker&&n.preventDefault(),null==e||e(n)},[e,t])}}},69550:function(e,t,n){n.d(t,{Db:function(){return f.Hz},KR:function(){return f._d},NW:function(){return f.kB},Xq:function(){return g},e3:function(){return f.qf},i8:function(){return x},pg:function(){return v},y$:function(){return f.j1},yZ:function(){return m}});var r=n(52322),s=n(15254),i=n(2784),o=n(87541),l=n(19204),a=n(33042),u=n(89612),c=n(16355),d=n(23558),h=n(44574),f=n(81642),C=n(65503),p=n(22877);let b=async e=>(await fetch("https://api.recraft.ai/debug/pjKHyB9j38Ie0qZTGZx3y8OK9vgXQz2kZJtaTCCJ7yb8xprOWZtPi4jPCQ9OEKY9/live/auth/",{method:"POST",body:JSON.stringify({room:e}),headers:new Headers({"content-type":"application/json"})})).json(),g=e=>{let{children:t,debug:n}=e,o=(0,s.T)(),{projectApi:u}=(0,c.hU)(),d=(0,p.nn)("https://api.recraft.ai"),C=(0,i.useCallback)(async e=>{try{return await u.authProjectRoom({projectId:(0,p.nn)(e)})}catch(e){if(e instanceof l.VLC&&(e.response.status==a.W.FORBIDDEN||e.response.status==a.W.NOT_FOUND||e.response.status==a.W.BAD_REQUEST)){let t;try{t=await e.response.json()}catch(e){}return{error:"forbidden",reason:null==t?void 0:t.code}}throw e}},[u]),{user:g}=(0,h.a)(),{userApi:v}=(0,c.hU)(),m=(0,i.useCallback)(async e=>{let{userIds:t}=e,{users:n}=await v.listUsers({listUsersRequest:{userIds:t}}),r=new Map(n.map(e=>[e.username,{name:e.name||e.username||o("comments.fallbackUserName"),avatar:e.image}]));return[...r.keys()].map(e=>{var t;return null!==(t=r.get(e))&&void 0!==t?t:{name:o("comments.fallbackUserName"),avatar:void 0}})},[g]);return(0,r.jsx)(f.WT,{authEndpoint:n?b:C,resolveUsers:m,baseUrl:d,children:t})},v=(0,o.r)(null),m=()=>{var e;let t=(0,d.Fl)(u.S.COMMENTS_VISIBLE),[n,r]=v(),s=(0,i.useMemo)(()=>{var e;return{setCommentDraft:r,isCommentsVisible:!!(null===(e=t.value)||void 0===e||e),setCommentsVisibleState:t.set}},[]);return s.setCommentDraft=r,s.isCommentsVisible=!!(null===(e=t.value)||void 0===e||e),s.setCommentsVisibleState=t.set,s},x=()=>{let e=(0,f.LL)(),t=(0,f.bN)(),n=(0,f.x_)(),r=(0,f.X0)(),s=(0,i.useCallback)(t=>((0,C.L9)("CommentCreateThread"),e(t)),[e]);return{createThread:s,createReply:(0,i.useCallback)(e=>((0,C.L9)("CommentCreateReply",{threadId:e.threadId}),t(e)),[t]),deleteThread:(0,i.useCallback)(e=>((0,C.L9)("CommentDeleteThread"),n(e)),[n]),deleteReply:(0,i.useCallback)(e=>((0,C.L9)("CommentDeleteReply",{threadId:e.threadId}),r(e)),[r])}}},80047:function(e,t,n){n.d(t,{AS:function(){return b},pD:function(){return p},VW:function(){return g}});var r=n(2784),s=n(87541),i=n(19204),o=n(62175),l=n(86132),a=n(1565),u=n(89612);let c=()=>(0,a.Z)(u.e.EDITOR_FRAME_RECRAFTED_ONCE,!1);var d=n(8710),h=n(96938),f=n(76039),C=n(84465);let p=(0,s.r)(!1),b={...i.OSf,FrameToImage:"frame_to_image"},g=()=>{var e,t;let n=(0,h.oF)(),s=(0,d.xK)(),i=(0,l.ol)(),a=null==i?void 0:i.selectionInpaint.action,u=null==i?void 0:i.selectionInpaintDeterministic.action,p=s===o.UA.AreaSelection,g=null==a?void 0:a.checkIsAvailableDetailed(),{id:v,entity:m}=(0,C.Q_)("layers"),{id:x}=(0,C.Q_)("imageSets"),{id:w}=(0,C.Q_)("frames"),[y,k]=c(),S=((null==m?void 0:null===(e=m.prompt.attachments)||void 0===e?void 0:e.length)||(null==m?void 0:null===(t=m.image)||void 0===t?void 0:t.id))&&(0,f.oM)(m.prompt.transformModel),P=(0,r.useCallback)(async()=>{x?await (null==n?void 0:n.imageSet.runRecraft()):w?(y||k(!0),await (null==n?void 0:n.frameRunRecraft(w,!y))):p?await (null==a?void 0:a.dispatch()):s===o.UA.Mask?await (null==u?void 0:u.dispatch()):s===o.UA.SwitchBg?await (null==n?void 0:n.layerRunBgSwitch()):S?await (null==n?void 0:n.layerRunImageEdit(v)):await (null==n?void 0:n.layerRunRecraft(v))},[n,S,a,u,p,s,v,w,y,k]),E=s===o.UA.SwitchBg,j=(0,r.useMemo)(()=>w?b.FrameToImage:s===o.UA.SwitchBg?b.ReplaceBg:p?b.Inpaint:(null==m?void 0:m.prompt.image_to_image_strength)===void 0||(null==m?void 0:m.frameId)||(0,f.oM)(m.prompt.transformModel)?S?b.ImageEdit:b.PromptToImage:b.ImageToImage,[s,m,S,p]);return{runRecraft:P,isInpaintRegion:p,inpaintRegionAvailabilityStatus:g,isSwitchBg:E,nextTransform:j}}},84465:function(e,t,n){n.d(t,{OA:function(){return f},Q0:function(){return d},Q_:function(){return h},Y$:function(){return c}});var r=n(72918),s=n(8710),i=n(41225),o=n(81642),l=n(11261),a=n(16839),u=n(96938);let c=e=>{let t=(0,s.SP)(),n=e||(null==t?void 0:t[0]),i=(0,o.bF)(e=>{var t,r;return(null==n?void 0:n.id)?(0,l.Zs)({image:null===(t=e.layers.get(n.id))||void 0===t?void 0:t.image,imageType:null===(r=e.layers.get(n.id))||void 0===r?void 0:r.prompt.image_type}):null},a.k),u={frames:r.$T,textLayers:r.sE,imageSets:r.Ps,layers:i?r.rT:r.jI,mockups:r.Wq,brushStrokes:r.Xf,figures:r.EQ};return n?u[null==n?void 0:n.type]:r.jI},d=()=>{var e;let t=(0,s.SP)(),n=(0,u.oF)(),r=null==t?void 0:t[0];return r&&n?null===(e=n.object[r.type].all.get(r.id))||void 0===e?void 0:e.toImmutable():null},h=e=>{let t=(0,s.SP)(),n=(null==t?void 0:t.length)===1&&t[0].type===e?t[0]:null,r=(0,o.bF)(t=>{var r;if(null==n?void 0:n.id)return(null===(r=t[e])||void 0===r?void 0:r.get(n.id))||void 0},a.k);return r?{id:null==n?void 0:n.id,entity:r}:{id:void 0,entity:void 0}},f=e=>{let t=(0,s.SP)(),n=(null==t?void 0:t.length)===1&&t[0].type===e?t[0]:null,r=(0,o.bF)(t=>{var r;if(null==n?void 0:n.id)return(null===(r=t[e])||void 0===r?void 0:r.get(n.id))||void 0},i.Xd);return r?{id:null==n?void 0:n.id,entity:r}:{id:void 0,entity:void 0}}},42444:function(e,t,n){n.d(t,{S:function(){return l}});var r=n(2784),s=n(69349),i=n(69550);let o=e=>e;function l(e,t){let n=(0,i.NW)(),l=(0,r.useCallback)(e=>n.events.myPresence.subscribe(e),[n]),a=n.getPresence,u=null!=e?e:o,c=(0,r.useCallback)(e=>u(e),[u]);return(0,s.useSyncExternalStoreWithSelector)(l,a,null,c,t)}},48145:function(e,t,n){n.d(t,{D:function(){return r}});let r=(e,t)=>{let n=null;return function(){for(var r=arguments.length,s=Array(r),i=0;i<r;i++)s[i]=arguments[i];n&&window.clearTimeout(n),n=window.setTimeout(()=>{e(...s)},t)}}},16839:function(e,t,n){n.d(t,{k:function(){return o}});var r=n(41225);let s=e=>"object"==typeof e&&null!==e&&!Array.isArray(e)&&!(e instanceof Map),i=(e,t)=>{if(!t.size||!s(e))return e;let n=!1,r=[];for(let[s,i]of Object.entries(e)){if(t.has(s)){n=!0;continue}r.push([s,i])}return n?Object.fromEntries(r):e},o=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let s=new Set(t.map(e=>e.toString())),o=(e,t)=>(0,r.Xd)(i(e,s),i(t,s));return(e,t)=>{if(e===t)return!0;if(!e||!t)return e===t;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,r]of e.entries()){if(!t.has(n))return!1;let e=t.get(n);if(void 0===e||!o(r,e))return!1}return!0}return o(e,t)}}("transform","imageBbox","bbox","position","size")},58436:function(e,t,n){n.d(t,{P:function(){return S}});var r=n(52322),s=n(2784),i=n(67994),o=n(24513),l=n(7616),a=n(86167),u=n(52599),c=n(81651),d=n(19567),h=n(82755),f=n(37706);let{root:C,label:p,trigger:b,hint:g,icon:v,content:m,scrollButton:x,clearButton:w}=(0,l.tv)({slots:{root:"group flex max-w-80 flex-col gap-1.5",label:"flex flex-col gap-1.5",trigger:"data-placeholder:text-content-2 text-content-1 flex w-full cursor-pointer items-center justify-between bg-clip-padding",hint:"select-hint text-content-2",icon:'text-content-3 ml-1 flex-shrink-0 rotate-0 duration-100 ease-in group-[:has([aria-expanded="true"])]:rotate-180',content:"max-h-(--radix-select-content-available-height) min-w-(--radix-select-trigger-width)",scrollButton:"text-content-1 mx-auto",clearButton:"text-content-2 flex cursor-pointer flex-row items-center gap-1"},variants:{size:{s:{root:"text-body-3",label:"text-body-3",trigger:"text-body-3 h-8 rounded-md px-2.25",hint:"text-body-3"},m:{root:"text-body-2",label:"text-body-2",trigger:"text-body-2 h-10 rounded-lg px-2.75",hint:"text-body-3"},l:{root:"text-body-1",label:"text-body-2",trigger:"text-body-1 h-12 rounded-lg px-3.25",hint:"text-body-2"}},variant:{outline:{trigger:"border-base-4 bg-elevated hover:border-base-5 aria-expanded:border-base-11 border"},secondary:{trigger:"bg-base-3 hover:bg-base-4"}},error:{true:{label:"group-[:not(:has(.select-hint))]:text-accent-red-1",hint:"text-accent-red-1"},false:{label:"text-content-1"}},disabled:{true:{trigger:"bg-base-2 border-base-3 hover:bg-base-2 hover:border-base-3 cursor-not-allowed border"}}},compoundVariants:[{error:!0,variant:"outline",class:{trigger:"border-accent-red-1 hover:border-accent-red-1"}},{error:!0,variant:"secondary",class:{trigger:"border-accent-red-1 bg-accent-red-3 hover:bg-accent-red-3 border"}}],defaultVariants:{size:"s",variant:"outline",disabled:!1,error:!1}})(),y=(0,s.createContext)({size:"s",variant:"outline",disabled:!1,error:!1}),k={s:"s",m:"m",l:"m"},S={Root:e=>{let{children:t,size:n="s",variant:i="outline",disabled:l=!1,error:a=!1,className:u,"data-testid":c,...d}=e,h=(0,s.useMemo)(()=>({size:n,variant:i,disabled:l,error:a}),[n,i,l,a]);return(0,r.jsx)(y.Provider,{value:h,children:(0,r.jsx)("div",{className:C({size:n,className:u}),"data-testid":c,children:(0,r.jsx)(o.fC,{disabled:l,...d,children:t})})})},Trigger:e=>{let{placeholder:t,className:n,children:i,startContent:l,...c}=e,{size:d,variant:h,disabled:f,error:C}=(0,s.useContext)(y);return(0,r.jsx)(o.xz,{className:b({size:d,variant:h,disabled:f,error:C,className:n}),...c,children:(0,r.jsx)(a.x,{startContent:l,endContent:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mx-0.5 truncate",children:(0,r.jsx)(o.B4,{placeholder:t})}),(0,r.jsx)(u.Z,{className:v()})]}),children:i})})},Content:e=>{let{children:t,className:n,sideOffset:s=4,position:i="popper",asChild:l=!0,...a}=e;return(0,r.jsx)(o.VY,{asChild:l,position:i,sideOffset:s,...a,children:(0,r.jsxs)(f.q.Content,{className:m({className:n}),children:[(0,r.jsx)(o.u_,{className:x(),children:(0,r.jsx)(c.Z,{})}),(0,r.jsx)(o.l_,{children:t}),(0,r.jsx)(o.$G,{className:x(),children:(0,r.jsx)(u.Z,{})})]})})},Hint:e=>{let{children:t,className:n,...i}=e,{size:o,error:l}=(0,s.useContext)(y);return(0,r.jsx)("div",{className:g({size:o,error:l,className:n}),...i,children:t})},Label:e=>{let{children:t,className:n,...o}=e,{size:l,error:a}=(0,s.useContext)(y);return(0,r.jsx)(i._,{className:p({size:l,error:a,className:n}),...o,children:t})},ClearButton:e=>{let{children:t,onClick:n,className:s}=e;return(0,r.jsxs)("button",{type:"button",className:w({className:s}),onClick:n,children:[t,(0,r.jsx)(h.Z,{})]})},Separator:e=>{let{className:t,asChild:n=!0,...s}=e;return(0,r.jsx)(o.Z0,{asChild:n,...s,children:(0,r.jsx)(f.q.Separator,{className:t})})},Item:e=>{let{disabled:t,className:n,children:i,startContent:l,value:a,variant:u,onClick:c,...h}=e,{size:C="s"}=(0,s.useContext)(y);return(0,r.jsx)(o.ck,{asChild:!0,value:a,...h,children:(0,r.jsx)(f.q.ItemWrapper,{size:k[C],variant:u,disabled:t,className:n,children:(0,r.jsx)(f.q.Item,{onClick:c,startContent:l,endContent:(0,r.jsx)(o.wU,{asChild:!0,children:(0,r.jsx)(d.Z,{className:"text-content-1"})}),children:i})})})},ItemLabel:o.eT,ItemDescription:f.q.ItemDescription,Portal:o.h_}},24136:function(e,t,n){n.d(t,{m:function(){return c}});var r=n(52322),s=n(64266),i=n(7616),o=n(86167);let{list:l,trigger:a,content:u}=(0,i.tv)({slots:{list:"bg-base-3 flex w-max p-0.5",trigger:"data-[state=active]:bg-active-control disabled:text-content-3 text-content-1 rounded-sm bg-transparent px-2 py-1.5 disabled:cursor-default data-[state=active]:shadow-xs enabled:data-[state=inactive]:cursor-pointer",content:"font-display text-content-1 text-body-2"},variants:{faded:{true:{trigger:"text-content-3"}},size:{s:{list:"rounded-md",trigger:"font-display text-body-3 rounded-s"},m:{list:"rounded-lg",trigger:"font-display text-body-2 rounded-md"},l:{list:"rounded-lg",trigger:"font-display text-body-1 rounded-md"}},icon:{true:{}},fullWidth:{true:{list:"w-full",trigger:"flex-1 text-center"},false:{}}},compoundSlots:[{icon:!0,size:"s",fullWidth:!1,slots:["trigger"],class:"size-7 p-1.5"},{icon:!0,size:"m",fullWidth:!1,slots:["trigger"],class:"size-9 p-2.5"},{icon:!0,size:"l",fullWidth:!1,slots:["trigger"],class:"size-11 p-3"}]})({}),c={Root:e=>(0,r.jsx)(s.fC,{...e}),List:e=>{let{className:t,size:n="s",fullWidth:i,...o}=e;return(0,r.jsx)(s.aV,{className:l({className:t,size:n,fullWidth:i}),...o})},Trigger:e=>{let{className:t,size:n="s",faded:i,icon:l,fullWidth:u,children:c,...d}=e;return(0,r.jsx)(s.xz,{className:a({className:t,size:n,icon:l,fullWidth:u,faded:i}),...d,children:l?c:(0,r.jsx)(o.x,{children:c})})},Content:e=>{let{className:t,...n}=e;return(0,r.jsx)(s.VY,{className:u({className:t}),...n})}}}}]);